---
nodes:
  - node1: {url}
  - node2: {url}

registry: {url}

services:
  - myapp:
    repo: {unique_repo}
    version: {tag}
    run: {command}
    env:
      key: val
    http: true
    needs:
      - redis: dsn
    provides:
      connection: unix:/tmp/myapp.sock
      http_endpoint: /stuff
    instances:
      num: 5
      nodes:
        - node1
        - node2

  - redis:
    repo: redis
    run: redis-server /etc/redis-config
    env:
      key: val
    provides:
      dsn: host:{port}/db0
    instances:
      nodes:
        - node1
